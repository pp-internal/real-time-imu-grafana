# IMU Mass Realtime IoT Data Collection and Visualization (POC)

This proof of concept was prepared in collaboration between engineers from Apptimia (www.apptimia.com) and Packet Path (www.packetp.com). Packet Path dealt with embedded, lower-level part of the project, whereas Apptimia focused on MQTT, Grafana and cloud. See the respective web pages of both companies for details of their portfolio and services. 

## Introduction
Real-time data streaming in the Internet of Things (IoT) enables applications to monitor, analyze, and automate processes based on data generated by IoT devices. This guide focuses on streaming data from the BMI160 IMU sensor using MQTT and visualizing it with tools like Grafana and InfluxDB.

## System Overview
The process consists of two main parts:

- Data Collection: Interfacing the BMI160 IMU sensor with a Raspberry Pi to collect accelerometer and gyroscope data, then streaming it via MQTT.
- Data Visualization: Using Grafana with InluxDB and Telegraf to visualize the real-time sensor data.
## Hardware Components
- Raspberry Pi 3/4: The computing unit for sensor interfacing and data streaming.
- BMI160 IMU Sensor: A compact, low-power sensor for motion and orientation detection.
This guide will walk you through the setup, configuration, and real-time monitoring of sensor data using MQTT.

This repository contains the setup for a Docker-based environment to collect, monitor and visualize IMU data using Grafana and InfluxDB.

## Prerequisites

Ensure you have the following installed before proceeding:

1. **Docker**: [Download Docker](https://www.docker.com/products/docker-desktop).
2. **Docker Compose**:
   - On Windows and Mac, Docker Compose is included with Docker Desktop.
   - On Linux, you can install it separately using:
     ```bash
     sudo apt-get update
     sudo apt-get install docker-compose
     ```
3. **Python dependencies**: Ensure you have Python 3.x installed. Then, create a virtual environment and install dependencies:
   ```bash
   python -m venv venv
   source venv/bin/activate  # Linux/Mac
   venv\Scripts\activate     # Windows
   pip install -r requirements.txt
4. Clone the Repository:
   ```bash
   git clone https://github.com/Apptimia/rt-sensor-mqtt-grafana.git
   cd rt-sensor-mqtt-grafana
   ```
5. Edit .env file and start 'IMUProcessor.py' script
   Change the HOST_IP line in the .env file and set to your RaspberryPi's address
   ```bash
   # Change to your own IP of the host machine (raspberry pi)
   HOST_IP=<Raspberry pi IP>
   ```

## Running the Services

1. Start the `IMUProcessor.py` Script on the Raspberry Pi
   
   On the Raspberry Pi, navigate to `bmi_160_i2c` containing IMUProcessor.py and run the script:
   ```bash
   cd bmi_160_i2c
   python IMUProcessor.py
   ```
   Refer [bmi_160_i2c/README.md](https://github.com/Apptimia/rt-sensor-mqtt-grafana/blob/main/bmi_160_i2c/README.md) for setting up Raspberry Pi
2. Build and Run Docker Containers

   Perform the following steps on your computer to build and start the Docker containers:
   - Option 1: Use Docker Compose to build and start the containers:
   ```bash
   docker-compose up -d --build
   ```
   - Option 2: Run the start.sh script:
      - Make the start.sh script executable: Before running start.sh, ensure it's executable:
      ```bash
      chmod +x start.sh
      ```
      - Run the start.sh script:
      ```bash
      ./start.sh
      ```
## Accessing the Services

1. Access Grafana
 - Open your web browser and navigate to http://localhost:3000.
 - Log in using the default credentials:
Username: admin
Password: admin
 - Click Skip to bypass the password change prompt.
 - Go to the Dashboards tab in the left-hand menu.
 - Select the BMI or PPG dashboard from the list.
 - Wait for the database to load and display the data.

2. Access InfluxDB
 - Open your web browser and navigate to http://localhost:8086.
 - Log in using the default credentials:
Username: admin
Password: adminadmin
 - Go to the Explore tab in the left-hand menu.
 - Choose the BUCKET that contains your data.
 - In the Filter section, set a filter for sensor or sensor_filtered.
 - Click Submit to view the data.
 - Use the Window Period field to adjust the display interval as needed.

3. Edit Dashboards
   To edit dashboards you need:
 - Select and open the dashboard you want to edit.
 - In the top-right corner, click on Edit to enter edit mode.
 - Click the Save dashboard button, then choose Save as copy to create a duplicate.
 - Change the title, description, and folder as you like.
 - Save the dashboard.
 - Make any changes you need on the copy.
